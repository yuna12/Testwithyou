### 버전 확인
- python version : 3.8.5
- HeidiSQL version : 11.3
- Anaconda3 Jupyter notebook
___
### packages install
- pip install pandas
- pip install numpy 
- pip install psycopg2
- pip install nltk
___
### 문제 설명
#### *Q1*
    - *Q1.1* 총내원일수
    - *Q1.2* 내원일수의 최대값
    - *Q1.3* 내원일수의 최대값을 가지는 환자의 수

#### *Q2*
    - 3행 NAME을 대문자로 변경하여 출력하는 쿼리 생성 대소문자 구별 X
    - 위 쿼리와 CPT를 JOIN하여 ID가 같은 NAME을 출력
    - 7행 출력된 FROM 의 서브쿼리에서 앞글자의 a,b,c,d,e가 들어가고 중간에 HEART가 들어가는 이름 SELECT

#### *Q3*
    - person_id가 1891866 인 사람 출력
    - drug_date는 복용일 
    - drug_date를 내림차순으로 정렬 (복용일이 긴 순으로 정렬)
    - 위의 출력한 서브쿼리를 기준으로 복용일(drug_date)를 합한 값과, 처음 복용일(MIN), 마지막 복용일(MAX) 값을 출력
    ※ 같은 환자의 같은 복용 약이 여러 개 있어 해당 약의 처음 복용일과 마지막 복용일을 MIN, MAX로 기준하였음.

#### *Q4*
    ※ WITH절의 ERROR로 인하여 WITH절을 사용하지 않고 실행하였음.
    - conceptid1을 기준으로 rownum 컬럼을 새로 생성 (해당 컬럼을 id값으로 사용)
    - 22행 ~ 36행 id1의 처방건수와 내림차순으로 정렬하여 rownum 컬럼 생성
    - 40행 ~ 53행 id2의 처방건수와 id1을 기준으로 내림차순한 rownum 컬럼 생성
    - 20행 ~ 54행 위 2개의 서브쿼리를 JOIN하여 각각 id1, id2의 처방건수를 합친 데이터 생성
    - 18행 ~ 55행 위의 생성한 프레임으로 ID1보다 ID2가 높은 ID1과 처방건수 출력
    - 1행 ~ 14행 DRUGS와 위의 프레임과 JOIN하여 DRUGS의 아이디와 ID1이 같은 컬럼 출력
    - 처방건수를 오름차순으로 정렬


#### *Q5*
    - 제 2형 당뇨병 환자를 먼저 추출
    - 현재 날짜를 기준으로 환자의 태어난 연도를 빼 나이를 구함
    - 위의 두 서브 쿼리를 이용하여 나이가 18세 이상 2형 당뇨병 환자를 앓는 환자를 JOIN 하여 출력
     *JOIN
    - 복용약이 Met~~~ 약을 복용하는 환자의 복용일을 출력하는 쿼리행 생성
    - 바로 위 쿼리문을 FROM 절에 서브쿼리로 이용하여 복용일이 90일이 넘어가는 사람을 출력

    - 위 두 개의 쿼리행을 ID가 같은 것 끼리 출력
    - 마지막으로 출력된 쿼리행에서 COUNT로 개수를 집계하여 출력

#### *Q6*
    - 제 2 당뇨병 환자를 먼저 6행의 조건으로 서브쿼리 생성
    - 10행의 해당 약을 복용하는 환자 서브쿼리 생성
    - 두 위의 서브쿼리를 11행의 조건으로 JOIN
    - 위의 JOIN한 쿼리문을 FROM절의 입력 3행
    - 13행의 ORDER BY를 ID와 시작일을 기준으로 오름차순정렬
    - 1행에서 각각 약의 맞게 PATTERN 컬럼을 새로 생성

#### *Q7*
    - clinical에서 nltk를 이용하여 라인 단위로 분리
    - 분리된 데이터를 데이터프레임으로 전환
    - 전환된 데이터프레임을 각 컬럼명을 바꾸고 데이터를 해당 컬럼의 맞게 변환
    - 전처리 완료된 데이터프레임을 INSERT 